## 12장 로드 밸런서
-----------------------------------
-----------------------------------
### 1. 부하 분산 
#### &nbsp; 1) 부하 문제 해결 방안 : 로드 밸런서
##### &nbsp; &nbsp;  - 동일한 서비스를 하는 다수의 서버가 등록되고 사용자로부터 서비스 요청이 오면 로드밸런서가 받아 사용자별로 다수의 서버에 서비스 요청을 분산시켜 부하를 분산
##### &nbsp; &nbsp;  - 서비스를 위한 가상 IP를 하나 제공하고 사용자는 각 서버의 개발 IP 주소가 아닌 동일한 가상 IP를 통해 각 서버로 접근
> ##### FWLB : 방화벽 분산
> ##### SLB : 서버 부하 분산

<br>

### 2. L4 로드밸런서 vs L7 로드밸런서
#### &nbsp; 1) L4 로드밸런서
##### &nbsp; &nbsp;  - 전송 계층에서 로드를 분산
##### &nbsp; &nbsp;  - IP주소나 포트번호, MAC주소 등에 따라 트래픽을 나누고 분산처리 가능
##### &nbsp; &nbsp;  - CLB(Connection Load Balancer) 혹은 SLB(Session Load Balancer)이라고 부름
#### &nbsp; 2) L7 로드밸런서
##### &nbsp; &nbsp;  - 애플리케이션 계층에서 로드를 분산
##### &nbsp; &nbsp;  - OSI 7계층의 프로토콜(HTTP, SMTP 등)을 바탕으로 분산 처리가 가능


|  | L4 로드밸런서 | L7 로드밸런서 |
|:---:|:---:|:---:|
| 네트워크 계층 | 4계층 : 전송계층 | 7계층 : 응용계층 | 
| 특징| TCP/UDP 포트 정보를 바탕으로 함 | TCP/UDP 정보는 물론 HTTP, FTP 파일명 등을 바탕으로 함 | 
| 장점| - 데이터 안을 들여다 보지 않고 패킷 레벨에서만 로드를 분산하기 때문에 속도가 빠르고 효율이 높음 <br> - 데이터의 내용을 복호화할 필요가 없기에 안전함 <br> - L7로드밸런서보다 가격이 저렴함 | - 상위 계층에서 로드를 분산하기 때문에 훨씬 더 섬세한 라운팅이 가능 <br> - 캐싱 기능을 제공함 <br> - 비정상적인 트래픽을 사전에 필터링할 수 있어 서비스 안정성이 높음 | 
| 단점| - 패킷의 내용을 살펴볼 없기 떄문에 섬세한 라우팅이 불가능함 <br> - 사용자의 IP가 수시로 바뀌는 경우라면 연속적인 서비스를 제공하기 어려움| - 패킷의 내용을 복호화해야 하기에 더 높은 비용을 지불해야 함 <br> - 클라이언트가 로드밸런서와 인증서를 공유해야하기 때문에 공격자가 로드밸런서를 통해서 클라이언트에 데이터에 접근할 보안 상의 위험성이 존재 | 
<br>

### 3. 부하 분산 알고리즘
#### &nbsp; 1) 라운드 로빈
##### &nbsp; &nbsp;  - 서버에 들어온 요청을 순서대로 트래픽을 분산
##### &nbsp; &nbsp;  - 모든 서버의 누적 세션 수 동일
##### &nbsp; &nbsp;  - 클라이언트의 요청을 순서대로 분배하기 때문에 여러 대의 서버가 동일한 스팩을 가지고 있고, 서버와의 연결(세션)이 오래 지속되지 않는 경우에 활용하기 적합
#### &nbsp; 2) 최소 접속 방식
##### &nbsp; &nbsp;  - 서버가 가진 세션 부하를 확인해 그것에 맞게 부하를 분산하는 방식
##### &nbsp; &nbsp;  - 각 장비의 세션 수를 확인해 현재 세션이 가장 적게 연결된 장비로 서비스 요청을 보내는 방식
##### &nbsp; &nbsp;  - 각 장비에서 처리되는 활성화 세션 수가 비슷하게 분산되면서 부하를 분산
#### &nbsp; 3) 해시
##### &nbsp; &nbsp;  - 서버의 부하를 고려하지 않고 클라이언트가 같은 서버에 지속적으로 접속하도록 하기 위해 사용하는 부하 분산 방식
##### &nbsp; &nbsp;  - 해시 알고리즘을 이용해 얻은 결괏값으로 어떤 장비로 부하를 분산할지를 결정
#### &nbsp; 4) 가중 라운드로빈 방식
##### &nbsp; &nbsp;  - 각각의 서버마다 가중치를 매기고 가중치가 높은 서버에 클라이언트 요청을 우선적으로 배분하는 방식
#### &nbsp; 5) 최소 리스폰타임
##### &nbsp; &nbsp;  - 서버의 현재 연결 상태와 응답시간을 모두 고려하여 트래픽을 배분하는 방식
##### &nbsp; &nbsp;  - 가장 적은 연결 상태와 가장 짧은 응답시간을 보이는 서버에 우선적으로 로드를 배분

 
